{
\abnormalparskip{0pt}
\chapter{Preliminaries}
\label{cha:preliminaries}
}

% Short introduction to the chapter (max 1/2 page)
The following chapter introduces basic concepts and definitions which either
help in understanding the problem area of the thesis, or which are directly used
by the thesis. The most important keywords of this chapter, which are directly
used in the thesis, are:
%
\begin{itemize}
\item Topologies and trees
\item Steiner trees: \aclp{fst}, \aclp{smt}
\item \aclp{estp}
\item Fermat-Torricelli point/problem
\end{itemize}
%
At the same time this chapter will introduce versions of the Steiner tree
problem which are not used directly by the thesis, but which help to give an
understanding of the problem area of the thesis, and which are mentioned in
\cref{cha:introduction} or discussed in \cref{cha:discussion}.

This chapter is mostly based on~\textcite{smith1992,gilbert1968,brazil2015} and
will by large follow the structure of~\cite[ch.~1]{brazil2015}.

\section{The Fermat-Torricelli Problem}
\label{sec:ferm-torr-probl}

Before introducing the Steiner problem, it is relevant to introduce the
Fermat-Torricelli problem, as this can be seen as a sort of subproblem to be
solved when solving the Steiner tree problem.

\newpage

The Fermat-Torricelli problem\footnote{The problem is so named as it was first
  proposed by \textcite{fermat1891} and the earliest known solution was put
  forth by \textcite{torricelli1919}.} in it classical two dimensonal form, is
defined as follows:
%
\begin{center}
\begin{tabular}{rp{9cm}}
  \toprule
  \textbf{Given} & A set of three points $V = \{p_1, p_2, p_3\}$ lying in the plane. \\
  \textbf{Find}  & A point $s$ such that the sum of the Euclidean distances from
                   $s$ to $p_1, p_2$ and $p_3$ is minimized. \\
  \bottomrule
\end{tabular}
\end{center}
%
The point $s$ will be referred to as a Steiner point\footnote{In the
  Fermat-Torricelli problem this point would normally be named the Fermat point
  or the Fermat-Torricelli point. However for clarity as to the connection
  between this problem and the Steiner problem this term is used. The name of
  both the Steiner problem/tree/point is named after Jakob Steiner, which might
  be errornous, who supposedly studied the Steiner problem for $3$
  terminals~\cite{brazil2014}.}. There are several ways to solve this problem,
e.g.\ using the rotation-proof~\cite[p.~3--5]{brazil2015}.

This formulation of the problem can be seen as a specialized instance of the
more general problem, where the edges are weighted. In the classical version the
edge weights are all equal to each other.

The generalized version for two dimensions of the problem can be formulated as in
\textcite{uteshev2014}:
%
\begin{center}
  \begin{tabular}{rp{9cm}}
    \toprule
    \textbf{Given} & Three noncolinear points $p_1 = (x_1, y_1)$, $p_2 = (x_2,
                     y_2)$ and $p_3 = (x_3, y_3)$ in the plane. \\
    \textbf{Find} & The point $p_\ast = (x_\ast, y_\ast)$ which gives a solution
                    to the optimization problem
                    \begin{gather}
                      \min_{(x,y)} F(x,y) \quad \text{for} \\
                      F(x,y) = \sum_{j=1}^3 m_j \sqrt{{(x-x_j)}^2 + {(y-y_j)}^2}
                    \end{gather}
    Where the weight of $j$th point, $m_j$, is a real positive number. \\
    \bottomrule
  \end{tabular}
\end{center}
%
The generalized Fermat-Torricelli problem can be even further generalized from
two dimensions to $d$ dimensions, with $d \ge 2$
\cite{fermattorricelliproblem}. This simply requires the points to be
$d$-dimensional, and we then change the optimization problem to the following:
%
\begin{gather}
  \min_{(x_1, x_2, \ldots, x_d)} F(x_1, x_2, \ldots, x_d) \quad \text{for} \\
  F(x_1, x_2, \ldots, x_d) = \sum_{j=1}^3 m_j
  \sqrt{\sum_{i=1}^d {(x_i - x_{(j,i)})}^2 }
  \\ \Updownarrow \\
  \label{eq:4}
  \min_{(p)} F(p) \quad \text{for} \quad
  F(p) = \sum_{j=1}^3 m_j | p p_j |, \quad p \in \mathbb{R}^d
\end{gather}
%
Solving the Fermat-Torricelli problem with even weights is equivalent with solving
the smallest possible instance of the \acl{estp}. The analytical solution
presented by~\textcite{uteshev2014} and a generalization of it to $\mathbb{R}^d$ is
presented in \cref{sec:analyt-solut-ferm}.

\section{The Euclidean Steiner Tree Problem}
\label{sec:eucl-stein-tree}

We firstly define a graph $G = (V(G), E(G))$ where the vertices $V(G)$ are
points of the graph, $V(G) \subset \mathbb{R}^d$ and the edges
$E(G) \subset (\mathbb{Z}^{+} \times \mathbb{Z}^{+})$ are straight lines connecting the points in
$V(G)$. The euclidean length of edge $e \in E(G)$ we denote $|e|$.

The \ac{estp} is then defined as follows:
%
\begin{center}
  \begin{tabular}{rp{9cm}}
    \toprule
    \textbf{Given} & A set of points $R = \{ p_1, p_2, \ldots, p_n \}$ in
                     $\mathbb{R}^d$. \\
    \textbf{Find} & A graph $T = (V(T), E(T))$ such that $R \subseteq V(T)$, and
                    $|T| = \sum_{e \in E(T)} |e|$ is minimized. \\
    \bottomrule
  \end{tabular}
\end{center}
%
Note that $T$ must be a tree, as any cycles can obviously be removed
without disconnecting the graph or increasing the length.

\section{Steiner Minimal Tree}
\label{sec:steiner-minimal-tree}

A \ac{smt} can be defined either as in~\textcite{brazil2015} or
in~\textcite{smith1992}. These are equivalent and the second can be proven
to follow from the first. Thus we here present the first as the definition, and
show how the properties which define the second follow. Thus:
%
\begin{definition}[\acl{smt}, Steiner points, terminals]
  A tree $T = (V(T), E(T))$ representing a solution to the Steiner tree problem
  is called a \acl{smt}. The given points $R \subseteq V(T)$ are called
  terminals and possible extra vertices $S = V(T) \setminus R$ are called
  Steiner points.
\end{definition}
%
It turns out that that a \ac{smt} has the following four properties which can
also be used as a definition:
%
\begin{definition}[\acl{smt}, Steiner points, terminals]
\leavevmode\vspace{-\baselineskip}\par
\begin{enumerate}
\item It contains $n$ ``terminals'' $R = \{ p_1, p_2, \ldots, p_n \} \in \mathbb{R}^d$, and
 possibly $k$ additional ``Steiner points'' $S = \{ p_{n+1}, \ldots, p_{n+k} \} \in \mathbb{R}^d$.
\item Each Steiner point has degree $3$, the edges emanating from it lie in
  the same plane and have a mutual angle of $120^{\circ}$
\item Each terminal has degree at most $3$.
\item $0 \le k \le n-2$.
\end{enumerate}
\end{definition}
%
\begin{proof}
The first property is by definition, to name the terminals and the
Steiner points.

The second and third property can be shown in the following way: First consider that
any Steiner point must have at least degree $3$. This should be obvious as a
Steiner point with degree $1$ does not connect any terminals to the rest of the
tree, and thus the point can simply be removed to either shorten the tree or
keep it the same\footnote{Which could happen if a Steiner point was lying atop
  the point is connected to.}. Furthermore every Steiner point with a degree
of $2$ can be removed, and its edges be replaced with one edge that is of the
same length or shorter as per the Triangle Inequality
Theorem\cite{triangleinequality}.

We now show that no pair of edges emanating from a Steiner point can have a
mutual angle less than $120^{\circ}$. This can proved in a few different
ways. The one used by \textcite{gilbert1968} is based on the mechanical model
presented described in the same article. A simpler approach in my own opinion
however is the one used by \textcite{brazil2015}. The proof is follows: Consider
a point $a$ in $T$, and a pair of non-zero edges $ab, ac \in E(T)$ meeting at
$a$. Note that $ab$ and $ac$ must form a shortest interconnection of the points
$\{a, b, c\}$ and furthermore we know that a solution the Fermat-Torricelli
problem for $\{ a, b, c \}$ forms a shortest interconnection as well. An
immediate consequence\footnote{This stems from the fact that the
  Fermat-Torricelli problem has a solution at one of the points if any of the
  angles is greater than $2 \pi / 3$ and somewhere between them otherwise. The
  details can either be found in \textcite[ch.~1]{brazil2015} or somewhat
  implicitly in \cref{sec:analyt-solut-ferm}.} of this is that the angle between
$ab$ and $ac$, denoted $\angle bac$ must be at least $2 \pi / 3 = 120^{\circ}$.
To see that this is true, assume that it is smaller; We then have two cases as
shown in \cref{fig:preliminaries-steiner-point} and in neither cases is $ab$ and
$ac$ a shortest interconnection of $\{a, b, c\}$.
%
\afterpage{
\begin{figure}[htbp]
\centering
\includegraphics[width=0.6\textwidth]{gfx/tikz/preliminaries-steiner-points}
\caption[Obtaining shorter trees]{Replacing a pair of edges $ab$ and $ac$ for which
  $\angle bac < 2 \pi / 3$ with a shortest interconnection provided by a
  solution to the Fermat-Torricelli problem for $\{a,b,c\}$. The left figure has
  no angle greater than $120^{\circ}$. The right has a angle
  $\angle cba \ge 120^{\circ}$. In both cases a shorter tree is
  constructed\footnotemark.\label{fig:preliminaries-steiner-point}}
\end{figure}
\footnotetext{This figure is the same as in \textcite[p.~7]{brazil2015}.}}
%
Using that the mutual angles may be no less than $120^{\circ}$ it follows that
any point in $T$ can have at most degree $3$\footnote{As
$3 \cdot 120^{\circ} = 360^{\circ}$ meaning that there is at most room for three
edges around a point.}. It therefore follows that terminals have a degree of at
most $3$, which proves the third property, and that Steiner points have a
degree of exactly $3$ and thus also mutual angles of precisely $120^{\circ}$,
proving the second property.

The fourth property follows in the following way from property 3 and 4. Any
tree $T$ has $|V(T)|-1$ edges. Thus a Steiner tree has $n+k-1$ edges.
Every edge has two endpoints meaning there are $2 n + 2 k - 2$ edges. As every
Steiner point has a degree of $3$, they account for $3 k$ of the endpoints. For
the terminals we must split them in three groups: $n_1$, those that have a
degree of $1$. $n_2$, those that have a degree of $2$ and, $n_3$, those that
have a degree of $3$. The terminals thus account for the rest of the
endpoints, written as $n_1 + 2 n_2 + 3 n_3 \ge n$. We can then write the
equation as
%
\begin{align}
  \label{eq:22}
  3 k + n_1 + 2 n_2 + 3 n_3 &= 2 n + 2 k - 2 \\
  k &= 2 n - 2 - (n_1 + 2 n_2 + 3 n_3) \\
  0 \le k &\le n - 2
\end{align}
%
Thus proving the fourth property.
\end{proof}

\section{Topologies}
\label{sec:topologies-1}

A topology is the combinatorial structure of a tree, or other form of geometric
network. This means that in a topology only the adjacencies of points
matter. Thus we could represent the topology of the tree $G = (V(G), E(G))$ as
just the edges of the tree $E(G)$. Thus any graph (and tree) has an
underlying topology.

We call any tree of some topology non-degenerate if all edges of the tree have
non-zero length---otherwise the tree is called degenerate.

We now define a Steiner topology, and a \ac{fstp} as the following
%
\begin{definition}[Steiner topology, \acl{fstp}]
The topology of a non-degenerate \ac{smt} is called a Steiner topology. The
topology of a non-degenerate \ac{smt} in which every terminal has degree 1 is
called a \acl{fstp}.
\end{definition}
%
Notice that a \ac{fstp} must necessarily have the most possible Steiner points
so $ k = n - 2$. This can be seen by substituting $n_2 = n_3 = 0$ and $n_1 = n$
in \cref{eq:22}.

\section{Steiner trees}
\label{sec:steiner-trees}

Before defining Steiner trees we define \acp{rmt} as in~\cite{gilbert1968}
as:
%
\begin{definition}[\acl{rmt}]
  A tree is called a \acl{rmt} if it is the shortest possible tree of its
  underlying topology.
\end{definition}
%
As can easily be seen a \ac{smt} must also be a \ac{rmt} of its underlying
topology. Finally we define Steiner trees. Steiner trees currently have two definitions
which are not exactly identical.

The first is the definition used by \textcite{gilbert1968}, combined with the
definition for \acp{fst} in \textcite{smith1992}, is as follows:
%
\begin{definition}[Steiner tree, \acl{fst}]
  If a tree can be shortened no further even when splitting is allowed, the tree
  is called a Steiner tree. If all of the original points\footnote{I.e.\ the
    points not inserted when splitting. These are what we have so far referred
    to as the terminals.} of a Steiner tree have degree 1 the tree is called a \acl{fst}.\label{def:steiner-tree}
\end{definition}
%
Here the process of splitting referred to is exactly what we do when e.g.\
inserting an extra point in the Fermat-Torricelli problem. Thus it follows
pretty straightforward that a Steiner tree must also be a \ac{rmt} of the
topology which describes it\footnote{Note that here we refer to the topology we
  end up with after we cannot split any more points, and not the topology we
  started out with.}. Furthermore any \ac{smt} must also be a Steiner tree, but not
vice versa as illustrated by \cref{fig:steiner-smts}.
%
\begin{figure}[htbp]
\centering
\includegraphics[width=0.6\textwidth]{gfx/tikz/steiner-smts}
\caption[Example of splitting and \acp{rmt}]{Example of how of splitting a
  point and inserting a new Steiner point. The flow shows two of the paths
  splitting could take on the shown topology down until no more splitting is
  possible. Optimizing the two final topologies, both are obviously \acp{rmt}
  of their underlying topology, but only the right one is a \ac{smt} as the
  other topology is degenerate (the two Steiner points lie on top of each other
  in the center). Thus if the original points are the terminals, only the last
  right tree is a \ac{smt} for the original terminals.\label{fig:steiner-smts}}
\end{figure}
%
The other, and newer definition, used by \textcite{brazil2015} is as follows:
%
\begin{definition}[Steiner tree, \acl{fst}]
  A non-degenerate (full) \ac{rmt} for a Steiner topology is called a (full)
  Steiner tree.\label{def:steiner-tree2}
\end{definition}
%
These definitions are not exactly identical as e.g.\ the last tree to the left in
\cref{fig:steiner-smts} would not be a Steiner tree by
\cref{def:steiner-tree2}\footnote{As it has an edge of length zero.}
but would be by \cref{def:steiner-tree}. The similarities of the two definitions
should however be obvious, and it also holds for both of the definitions that
any \ac{smt} must be a Steiner tree, and that any Steiner tree must be a
\ac{rmt} of its underlying topology.

\section{Finding Steiner Trees in 2D}
\label{sec:find-stein-trees-2}

% This section describes some of the existing ways of finding Steiner trees in two
% dimensions, e.g.\ The Hwang-Melzak algorithm\missingref{} and
% GeoSteiner\missingref{}, and why these do not generalize to higher dimensions.

\TODO[inline]{Simply do some referring here instead to Hwang-Melzak and
  GeoSteiner, maybe other?. Then describe the geometrical properties that make
  these algorithms work, and why this does not work in higher dimensions}

\section{Finding Steiner Trees in $d$-space}
\label{sec:find-stein-trees-d}

\TODO[inline]{Write about Smith*, Smith+, BranchEnumerate, etc.}

\section{Other Versions of the Steiner Tree Problem}
\label{sec:other-vers-stein}

% This section describes some specialized versions of the Steiner tree problem.

\TODO[inline]{Simple refer to different type of other trees like rectilinear and
  fixed orientation and such. This can be done by referring to the book, and
  possibly an article about prize collecting steiner trees.}

\chapterbreak{}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../main"
%%% End:
